/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    id 'net.onebeastchris.geyserperserverpacks.java-conventions'
    id 'com.github.johnrengelman.shadow' version '8.1.1'
}

dependencies {
    implementation project(':common')
    compileOnly("com.velocitypowered:velocity-api:3.0.0")
    compileOnly("org.geysermc.geyser:api:2.1.1-SNAPSHOT")
    compileOnly("org.geysermc.geyser:core:2.1.1-SNAPSHOT") {
        exclude(group: "io.netty")
        exclude(group: "com.github.GeyserMC", module: "MCAuthLib")
        exclude(group: "net.kyori")
        exclude(group: "com.github.GeyserMC", module: "opennbt")
    }
    annotationProcessor("com.velocitypowered:velocity-api:3.0.0")
    annotationProcessor("org.geysermc.event:events:1.1-SNAPSHOT")
}

build {
    setArchivesBaseName("geyserperserverpacks-velocity")
}

jar {
    dependsOn ':common:jar'
    archiveClassifier.set('unshaded')
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

shadowJar {
    archiveBaseName.set('geyserperserverpacks-velocity')
    archiveClassifier.set('')

    relocate('com.fasterxml.jackson', 'net.onebeastchris.geyserperserverpacks.jackson')
    relocate('org.yaml', 'net.onebeastchris.geyserperserverpacks.yaml')
}